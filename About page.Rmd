---
title: "About Page"
author: "Leena Ambady"
date: "2/25/2020"
output: html_document
---
Url to Repository: https://github.com/lambady/Final-Project-2-25-20.git 

For my final project, I want to look at rates of organ donation registration in New York. More specifically, I want to see whether organ procurement organizations or demographic factors have an affect on rates of registration. Organ procurement organizations are supposed to encourage registration and donation and education the counties that they serve. I've located three good datasets to help me with this.
1. One dataset from healthdata.gov tells me the % of the eligible population in New York who registered to be an organ donor, by county. 
2. Another dataset from the New York State government tells me about the different organ procurement organizations and which counties they serve. This has national data, but I've filtered it for just New York. 
3. The third dataset provides more information about organ procurement agencies, some of which is already covered by Dataset 2. I'm still looking through it to see if there is any more useful information in this dataset. 

So far, I have loaded the datasets and cleaned up some of the data. I am also planning on using demographic data from the Census, for which I have defined some variables below. I also would like to see whether trust in government is related to organ donation registration rates, but have had trouble finding any datasets that measure this so will continue to think about this in the next few weeks. My next steps will also include further cleaning and exploring my data.   

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
dir.create("raw-data")
library(readr)
library(tidyverse)
library(janitor)
library(dplyr)
library(readxl)
library(tidycensus)
library(stringr)
census_api_key("41e31e7dc9f4be0cac86dd847ae1e2e19837090b")
```

```{r Reading in data}
# This dataset contains the number of registry enrollments in each county of New
# York for the years 2008-2015

new_york <- read.csv("raw-data/Donate_Life_Organ_and_Tissue_Donor_Registry_Enrollment_by_County__Beginning_September_2008.csv") %>%
  clean_names()


# This data set contains information about the address and contact of each organ
# procurement agency in NY. Not sure if I will use this dataset but it's nice to
# have for now.

hrsa <- read.csv("raw-data/ORG_OTC_FCT_DET.csv") %>%
  clean_names

# This dataset contains informatinon about which organ procurement organization
# serves each county in NY. 

OPO <- read.csv("raw-data/Organ_Procurement_Organizations__Eye_Banks_and_Tissue_Banks_Information.csv")


```

```{r Cleaning New York Dataset}
new_york_cleaned <- rename(new_york, 
                           "2012 Census Population" = x2012_census_population,
                           "% Eligible Population Enrolled" = x_eligible_population_enrolled, 
                           "Population 18+ Estimate" = population_18_estimate, 
                           "Organ Procurement Organization" = opo, 
                           "Year" = year, "Month" = month, 
                           "County" = county, 
                           "Registry Enrollments" = registry_enrollments)
```

```{r Cleaning OPO and HRSA Datasets}
hrsa_cleaned <- hrsa %>%
  filter(organ_procurement_organization_state_abbreviation == "NY")

OPO_cleaned <- OPO %>%
  filter(Type == "Organ Procurement Organizations")
  
```

```{r Getting ACS Information that is of interest}
load_variables(2015, "acs5")

# This code gives me census data from 2015 about the differe ethnic/racial
# demographics in all the different counties of New York. I hope to join this
# with the county data that I have collected on rates of organ donor
# registration in each county of New York.

racevars <- c(White = "B02001_002", 
              Black = "B02001_003", 
              Asian = "B02001_005",
              Hispanic = "B03003_003",
              Puerto_Rican = "B03001_005",
              Dominican = "B03001_007")

ny_county_data <- get_acs(geography = "county",
                  variables = racevars, 
                  year = 2015,
                  state = "NY",
                  geometry = TRUE,
                  summary_var = "B02001_001")

```

```{r}
# One thing I want to do is link the census data for each county to the data
# about the number of registry enrollments in each county. I can do this by
# joining the new_york_cleaned and ny_county_data datasets. First, I need to
# alter the ny_county_data so that it can be joined. Currently the County names
# in this dataset are formatting like "Allegheny County, New York" whereas in
# the new_york_cleaned they are just "Allegheny." Below, I created a new column
# with just the first word so that I can join the datasets.

ny_county_data$County <- word(ny_county_data$NAME, 1)

# Another thing is that the ny_county_data demographic is just from 2015,
# whereas the registry data was recorded each month from 2008-2015. Right now, I
# will just filter it for 2015, but eventually I will need to figure out what
# dates I want to focus on, and if I want to get more demographic data from
# other ACS years. I am not sure it makes sense to have monthly data, and might
# just focus on different years.

County_enrollment_demographic_data <- new_york_cleaned %>%
  filter(Year == "2015") %>%
  full_join(ny_county_data, by = "County") %>%
  select(-summary_moe)

# Now I have one dataset with information on the number of enrollment registrations and the demographic data for each county in New York. 

View(
  new_york_cleaned %>%
filter(County == "Albany") %>%
  filter(Year == "2015")
)

```

